comment~
Author: Jenny Nguyen
Project: Project1C
Description: User name prompt
~

CONSOLE		equ		-11
KEYBOARD	equ		-10
CR			equ		0dh
LF			equ		0ah

extern GetStdHandle:	PROTO
extern WriteFile:		PROTO
extern ReadFile:		PROTO
extern ExitProcess:		PROTO

.data
prompt				byte	'What is your name? '

msg					byte	'****************************', LF, CR, '* '
myname				byte	40 dup(0)
msg2				byte	' *', CR, LF, '****************************'




.data?				
stdin				qword ?		;handle to sonsole standard in
stdout				qword ?		;handle to console standard out
numWrite			qword ?		;number of bytes actually written
numRead				qword ?		;number of bytes actually read

.code

mainCRTStartup		PROC					;initialize the program
					sub rsp, 40				;reserve shadow space


					;Get handle id to console window & keyboard
					mov rcx, CONSOLE		;/subsystem:console
					call GetStdHandle;		;handle in rax
					mov stdout, rax			;save out handle
					mov rcx, KEYBOARD		;keyboard code
					call GetStdHandle		;handle in rax
					mov stdin, rax			;save in handle

					;Display message on console window
					mov rcx, stdout			;parm1 = console handle
					lea rdx, prompt			;parm2 = ascii message
					mov r8, lengthof prompt ;# pf bytes to display(write)
					lea r9, numWrite		;& to store # of bytes written
					mov qword ptr [rsp + 32], 0   ;parm5 = 0 (unused)
					call WriteFile			;display message


					;Read ASCII from the keyboard
					mov rcx, stdin			;parm1 = keyboard handle
					lea rdx, myname			;parm2 = ascii buffer
					mov r8, lengthof myname ;# of bytes to read
					lea r9, numRead			;& to store #bytes actually read
					call ReadFile			;get keystrokes

					;Display message on console window
					mov rcx, stdout			;parm1 = console handle
					lea rdx, msg			;parm2 = ascii message


					;#bytes to display (write)
					mov r8, lengthof msg	;length 'msg,'
					add r8, numRead			;add length name
					sub r8, 2				;optional: remove the newLine
					lea r9, numWrite		;& to store #bytes written
					call WriteFile			;display message
					
					; trying to figure out how to print asterisks after name
					mov rcx, stdout			;parm1 = handle
					lea rdx, msg2			;parm2 = msg2
					mov r8, lengthof msg2	;bytes to display
					call WriteFile			;Display msg2

					;Finalize program and exit
					add rsp, 40				;restore shadow space
					mov rcx, 0				;return code %errorlevel%
					call ExitProcess		;exit
mainCRTStartup		ENDP

END

****************************
* Jenny Nguyen *
****************************
